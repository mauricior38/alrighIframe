/**
 * @license
 * Copyright (c) 2023 The Nuevodevel Team. All rights reserved.
 * Hotkeys Plugin for Video.js v7
 */
/*eslint no-inner-declarations: "off"*/import videojs from"video.js";const Plugin=videojs.getPlugin("plugin");class Hotkeys extends Plugin{constructor(e,t){super(e);var r=e.el(),n=document,o={volumeStep:.1,seekStep:5,enableMute:!0,enableVolumeScroll:!0,enableHoverScroll:!1,enableFullscreen:!0,enableNumbers:!0,enableJogStyle:!1,alwaysCaptureHotkeys:!0,captureDocumentHotkeys:!1,documentHotkeysFocusElementFilter:function(){return!1},enableModifiersForNumbers:!0,enableInactiveFocus:!0,skipInitialFocus:!1,playPauseKey:M,rewindKey:P,forwardKey:H,volumeUpKey:x,volumeDownKey:I,muteKey:L,fullscreenKey:N,customKeys:{}};videojs.options.blockKeys=!1;var i=!1,l=1,u=2,s=3,a=4,c=5,f=6,y=7,m=videojs.mergeOptions||videojs.util.mergeOptions;t=m(o,t||{});e.on("dispose",function(){document.removeEventListener("keydown",j);e.off("keydown",j);e.off("dblclick",F);e.off("mousewheel",q);e.off("DOMMouseScroll",q)});var v=t.volumeStep,d=t.seekStep,b=t.enableMute,p=t.enableVolumeScroll,k=t.enableFullscreen,h=t.enableNumbers,w=t.enableJogStyle,K=t.alwaysCaptureHotkeys,S=t.captureDocumentHotkeys,g=t.enableModifiersForNumbers,T=t.enableInactiveFocus,E=t.skipInitialFocus;if(!r.hasAttribute("tabIndex"))r.setAttribute("tabIndex","-1");r.style.outline="none";if(K||!e.autoplay())if(!E)e.one("play",function(){r.focus()});if(T)e.on("userinactive",function(){var t=function(){clearTimeout(o)},o=setTimeout(function(){e.off("useractive",t);var o=n.activeElement,i=r.querySelector(".vjs-control-bar");if(o&&o.parentElement===i)r.focus()},10);e.one("useractive",t)});e.on("play",function(){var e=r.querySelector(".iframeblocker");if(e&&""===e.style.display){e.style.display="block";e.style.bottom="39px"}});var j=function(o){var m,p=o.which||o.keyCode,T=[70,77,40,38,39,176,37,177,32,179];if(o.shiftKey)if(188!==p&&190!==p)return;if(!o.ctrlKey)if(!o.altKey)if(e.controls()){if([32,179,77,70].includes(p)){var E=(o.target||o.srcElement).tagName;if("INPUT"===E||"TEXTAREA"===E||"SELECT"===E)return}var j=n.activeElement;if(K||j===r||j===r.querySelector(".vjs-tech")||j===r.querySelector(".vjs-control-bar")||j===r.querySelector(".iframeblocker")){if(T.includes(p)){o.preventDefault();if(K||S)if(o.stopPropagation)o.stopPropagation();else if(window.event)window.event.cancelBubble=!0}if(70===p||77===p||32===p||179===p)if(i)return;i=!0;var F=e.playbackRates();if(o.shiftKey&&188===p){F.sort(function(e,t){return t-e});for(var q=0;q<F.length;q++)if(F[q]<e.playbackRate()){e.setRate(F[q]);break}}if(o.shiftKey&&190===p){F.sort(function(e,t){return e-t});for(q=0;q<F.length;q++)if(F[q]>e.playbackRate()){e.setRate(F[q]);break}}switch(D(o,e)){case l:if(e.paused())e.play();else e.pause();break;case u:if(videojs.options.blockKeys)break;m=e.currentTime()-d;if(e.currentTime()<=d)m=0;e.currentTime(m);break;case s:if(videojs.options.blockKeys)break;e.currentTime(e.currentTime()+d);break;case c:o.stopPropagation();if(videojs.options.blockKeys)break;if(!w)e.volume(e.volume()-v);else{m=e.currentTime()-1;if(e.currentTime()<=1)m=0;e.currentTime(m)}break;case a:if(videojs.options.blockKeys)break;if(!w)e.volume(e.volume()+v);else e.currentTime(e.currentTime()+1);break;case f:if(b)e.muted(!e.muted());break;case y:if(k)if(e.isFullscreen())e.exitFullscreen();else e.requestFullscreen();break;default:if(p>47&&p<59||p>95&&p<106)if(g||!(o.metaKey||o.ctrlKey||o.altKey))if(h){var M=48;if(p>95)M=96;var P=p-M;o.preventDefault();e.currentTime(e.duration()*P*.1)}for(var H in t.customKeys){var x=t.customKeys[H];if(x&&x.key&&x.handler)if(x.key(o)){o.preventDefault();x.handler(e,t)}}}}}},F=function(t){if(e.controls()){var o=t.relatedTarget||t.toElement||n.activeElement;if(o===r||o===r.querySelector(".vjs-tech")||o===r.querySelector(".iframeblocker"))if(k)if(e.isFullscreen())e.exitFullscreen();else e.requestFullscreen()}},q=function(t){if(e.controls()){var o=t.relatedTarget||t.toElement||n.activeElement;if(K||o===r||o===r.querySelector(".vjs-tech")||o===r.querySelector(".iframeblocker")||o===r.querySelector(".vjs-control-bar"))if(p){t=window.event||t;var i=Math.max(-1,Math.min(1,t.wheelDelta||-t.detail));t.preventDefault();if(1===i)e.volume(e.volume()+v);else if(-1===i)e.volume(e.volume()-v)}}},D=function(e,r){if(t.playPauseKey(e,r))return l;if(t.rewindKey(e,r))return u;if(t.forwardKey(e,r))return s;if(t.volumeUpKey(e,r))return a;if(t.volumeDownKey(e,r))return c;if(t.muteKey(e,r))return f;if(t.fullscreenKey(e,r))return y;else return};function M(e){return 32===e.which||179===e.which}function P(e){return 37===e.which||177===e.which}function H(e){return 39===e.which||176===e.which}function x(e){return 38===e.which}function I(e){return 40===e.which}function L(e){return 77===e.which}function N(e){return 70===e.which}document.addEventListener("keydown",j,!1);document.addEventListener("keyup",R,!1);e.on("dispose",function(){document.removeEventListener("keydown",j);document.removeEventListener("keyup",R)});function R(){i=!1}e.on("keydown",j);e.on("dblclick",F);e.on("mousewheel",q);e.on("DOMMouseScroll",q);return this}}videojs.registerPlugin("hotkeys",Hotkeys);export default Hotkeys;
